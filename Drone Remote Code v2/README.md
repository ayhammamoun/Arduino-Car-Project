This is the code for the version 2 code which will be much more improved
